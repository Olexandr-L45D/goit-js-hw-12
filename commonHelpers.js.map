{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixaday-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["\nimport axios from 'axios';\nconst BASE_URL = \"https://pixabay.com/api/\";\nconst API_KEY = \"44760113-b733d2f51a4c6409aa3483a05\";\naxios.defaults.baseURL = BASE_URL;  //тут посилання на базовий URL on axios\n\n      const params = {\n        key: API_KEY,\n        q: \"str\",\n        page: 1,\n        per_page: 15,\n        image_type: \"imageType\",\n        orientation: 'horizontal',\n        safesearch: true,\n        maxPage: 0 // додатковий параметр(який я потім порахую) для обчислення останньої сторінки\n      };\n\n      export {params};  \n\n  async  function getAsyncImage(searchText) {\n    params.q = searchText;\n     const neWurls = new URLSearchParams(params);  \n    const response = await axios.get(`?${neWurls}`)\n      return response.data;\n    };\n    \n    export {getAsyncImage};\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n    \n\n\n\n\n\n\n   ","//2 functions more\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\niziToast.settings({\n  timeout: 2500,\n  resetOnHover: true,\n  transitionIn: 'flipInX',\n  transitionOut: 'flipOutX',\n  position: 'topRight',\n  titleSize: 25,\n  messageSize: 25,\n  backgroundColor: 'rgba(255, 182, 66, 0.8)',\n});\nvar lightbox = new SimpleLightbox('.gallery a', { captionDelay: 200, captionsData: 'alt'  });\n\nexport const refs = {\n  formSearchImage: document.querySelector(\".uzers-form-image\"),\n  gallery: document.querySelector('.gallery'),\n  loadMoreBtn: document.querySelector('[data-action=\"load-more\"]'), //  це прислуховуєм кнопку з спінером\n  spinnerText: document.querySelector(\".spinner-text\") // це спінер тектом під кнопкою\n};\n\nconst galleryContainer = document.querySelector('.gallery'); // function створює розмітку для галереї\ngalleryContainer.addEventListener('submit', renderGalleryMarkap);\n\n   export function renderGalleryMarkap(images) {\n    const element = document.getElementsByClassName(\".gallery\");\n    element.innerHTML = \"\";\n    const markup = images\n    .map((image) =>  \n      ` \n    <li class=\"gallery-item\">\n    <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n    <img class=\"gallery-image\" src=\"${image.webformatURL}\" alt=\"${image.tags}\" title=\"${image.name}\"/></a>\n    <div class=\"gallery-paragraf\">\n    <p class=\"gallery-commant\">likes ${image.likes}</p>\n    <p class=\"gallery-commant\">views ${image.views}</p>\n    <p class=\"gallery-commant\">comments ${image.comments}</p>\n    <p class=\"gallery-commant\">downloads ${image.downloads}</p>\n    </div>\n    </li> \n     ` )\n      .join(\"\")\n      galleryContainer.insertAdjacentHTML(\"beforeend\", markup);\n      lightbox.refresh();\n      \n  };\n\n// функція виклика повідомлення про помилку and iziToast\n\nexport function handlerErrorUzer(error) {\n  switch (error)\n    {\n    case 'outdata':\n      iziToast.warning({\n        title: 'Error',\n        message: 'Введіть данні для пошуку!',\n      });\n      break;\n    case 'nodata':\n      iziToast.warning({\n        title: 'Error',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n      break;\n    default:\n      iziToast.error({\n        title: 'Error',\n        message: 'Щось пішло не так. Ми працюемо над вирішенням питання!',\n      });\n      break;\n  }\n}\n\n\n// const hiddenBattonClass = \"is-hidden\";\nconst hiddenBattonClass = \"hidden\";\n// взагалі зникає (коли кінець колекції або до запиту(до сабміту))\nfunction hiden(button) {\n  button.classList.add(hiddenBattonClass);\n} // активна\nfunction show(button) {\n  button.classList.remove(hiddenBattonClass);\n} // при запиті відображається але не активна для натискання і прелоудер-show this spinner\nfunction disable(button, spinner ) {\n  button.disabled = true;\n  spinner.classList.remove(hiddenBattonClass);\n} // -show this button and hide this spinner\n//  function enable(button, spinner) {\n//   button.disabled = falce; \n//   spinner.classList.add(hiddenBattonClass);\n//  }\nexport {hiden, show, disable};\n\n\n","\n\nimport {getAsyncImage, params} from \"./js/pixaday-api\"\nimport {handlerErrorUzer, refs} from \"./js/render-functions\"\nimport {renderGalleryMarkap} from \"./js/render-functions\"\nimport  {hiden, show, disable} from \"./js/render-functions\" // імпортую функції які ховають кнопку -Load more і показують спінер\n\nhiden(refs.loadMoreBtn); // приховав кнопку >Load more</button> перед самим початком як тільки завантажилась сторінка\nhiden(refs.spinnerText)\nrefs.formSearchImage.addEventListener('submit', onFormSubmit);\nrefs.loadMoreBtn.addEventListener(\"click\", handleLoadMore); // прослуховуе кнопку >Load more< по кліку\nlet searchText = \"\"  \nparams.page = 1;\n async function onFormSubmit(event) {  \n    event.preventDefault();\n    searchText = event.target.searchQuery.value.toLowerCase().trim();  //значення яке написав користувач(прибираєм пробіл та приводим до нижн регістра)\n  if (searchText === \"\") {\n    handlerErrorUzer('outdata');\n    return; }\n     refs.gallery.innerHTML = '';\n     params.page = 1;\n    \n    disable(refs.loadMoreBtn, refs.spinnerText); // кнопка не активна для натискання юзером (під час завантаження, щоб не натискав багато разів)\n    \n    try {\n      const data = await getAsyncImage(searchText);\n      if (data.hits.length === 0) {\n        handlerErrorUzer('nodata');  \n        return\n      }\n      renderGalleryMarkap(data.hits); //тут передаю функцію, яка відмальовує розмітку (тут не можна СКРОЛ так як вона одразу прокручує вверх )\n      disable(refs.loadMoreBtn, refs.spinnerText);\n\n      refs.loadMoreBtn.addEventListener(\"click\", createNewCard); // прослуховуе кнопку >Load more< по кліку\n    } catch (error) {\n      console.log(error);\n      handlerErrorUzer(error);\n       \n    } finally {\n      event.target.reset(); //очистка тексту в інпуті\n      show(refs.loadMoreBtn);\n    }\n    };\n \n     function handleLoadMore(params) {   // функція при події клік на кнопці яка виконую додавання нових порцій сторінок(збільшую знач page на один, відключаю кнопку, після запиту на сервер відмаловуємо розмітку і включаю як прийшов позитивний результат)\n      hiden(refs.loadMoreBtn);\n      show(refs.spinnerText); \n     //disable(refs.loadMoreBtn);\n      setTimeout(async () => {try {\n        const data = await getAsyncImage(searchText);\n        renderGalleryMarkap(data.hits); // вставляю window.scrollBy після того як вставив в дом зображення\n       const galleryItemScrol = document.querySelector('.gallery-item');\n       const cardHeight = galleryItemScrol.getBoundingClientRect().height; \n        window.scrollBy({\n          top: cardHeight * 2,\n          behavior: \"smooth\",\n        });\n        show(refs.loadMoreBtn);\n       } catch(error) {\n         console.log(error);\n         handlerErrorUzer(error);\n       }\n         finally {\n          if (params.page === params.maxPage) {\n                  hiden(refs.spinnerText);\n                  refs.loadMoreBtn.removeEventListener(\"click\", handleLoadMore);\n                } \n         }}, 1000);\n       } ;\n\n  //  розрахунок максимальної кількості сторінок (Поки не працює)\n    // try { const {markup, totalHits} = await getAsyncImage(params); //тут передаю функцію яку хочу обробити в try...catch\n    // params.maxPage =  Math.ceil(totalHits / params.per_page); // розрахунок максимальної кількості сторінок \n    // // console.log(markup, totalHits); // markup - масиви який створюю в renderGalleryMarkap\n    //    } catch (error) {\n    //      console.log(error);\n    //    }\n\n     // Кінець колекції?\n      // if (data.hits.length > 0 && data.hits.length === totalHits) {\n      //   enable(refs.loadMoreBtn, refs.spinnerText); // розблоковую кнопку для натискань\n      // }\n       \n      function createNewCard(amount) {\n        params.page += 1;\n    \n       for (let i = 0; i < amount; i++) {\n        renderGalleryMarkap(data.hits);\n        \n      }\n       \n      \n      }"],"names":["BASE_URL","API_KEY","axios","params","getAsyncImage","searchText","neWurls","iziToast","lightbox","SimpleLightbox","refs","galleryContainer","renderGalleryMarkap","images","element","markup","image","handlerErrorUzer","error","hiddenBattonClass","hiden","button","show","disable","spinner","onFormSubmit","handleLoadMore","event","data","createNewCard","cardHeight","amount","i"],"mappings":"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"}